!function(){"use strict";class e{constructor(e,t,s,r,i){this._title=e.name,this.cardId=e._id,this._image=e.link,this.isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteButton=r,this._handleLikeButton=i}toggleCardLike(){this._cardLikeButton.classList.toggle("card__like-button_active")}removeCard(){this._element.remove()}_setEventListeners(){this._cardImage.addEventListener("click",()=>{this._handleImageClick({name:this._title,link:this._image})}),this._cardLikeButton.addEventListener("click",()=>{this._handleLikeButton(this)}),this._cardDeleteButton.addEventListener("click",()=>{this._handleDeleteButton(this)})}generateCard(){return this._template=document.querySelector(this._cardSelector),this._element=this._template.content.querySelector(".card").cloneNode(!0),this._cardTitle=this._element.querySelector(".card__title"),this._cardImage=this._element.querySelector(".card__image"),this._cardLikeButton=this._element.querySelector(".card__like-button"),this._cardDeleteButton=this._element.querySelector(".card__delete-button"),this._cardImage.src=this._image,this._cardImage.alt=this._title,this._cardTitle.textContent=this._title,this._setEventListeners(),this.isLiked&&this._cardLikeButton.classList.add("card__like-button_active"),this._element}}class t{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._submitSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitSelector)}_showErrors(e,t){e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideErrors(e,t){e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.validity.valid?this._hideErrors(e,t):this._showErrors(e,t)}_toggleButtonState(){this._inputList.some(e=>!e.validity.valid)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach(e=>{e.addEventListener("input",()=>{this._checkInputValidity(e),this._toggleButtonState()})}),this._inputList.every(e=>e.validity.valid)&&this._inputList.forEach(e=>{e.addEventListener("keydown",e=>{"Enter"===e.key&&this._submitButton.click()})})}enableValidation(){this._setEventListeners()}resetValidation(){this._formElement.reset(),this._toggleButtonState(),this._inputList.forEach(e=>{const t=this._formElement.querySelector(`.${e.id}-error`);this._hideErrors(e,t)})}}class s{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._renderedItems.forEach(e=>{this._renderer(e)})}addItem(e){this._container.prepend(e)}}class r{constructor(e){this._modal=document.querySelector(e)}open(){this._modal.classList.add("modal_opened")}close(){this._modal.classList.remove("modal_opened")}setEventListeners(){this._modalCLoseButton=this._modal.querySelector(".modal__close-button"),this._modalCLoseButton.addEventListener("click",()=>{this.close()}),this._modal.addEventListener("click",e=>{e.target.classList.contains("modal")&&this.close()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.close()})}}class i extends r{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._modal.querySelector(".modal__form"),this._inputList=this._form.querySelectorAll(".modal__input"),this._submitBtn=this._form.querySelector(".modal__save-button")}_getInputValues(){const e={};return this._inputList.forEach(t=>{e[t.name]=t.value}),e}setInputValues(e){this._inputList.forEach(t=>{t.value=e[t.name]})}renderLoading(e){this._submitBtn.textContent=e?"Saving ...":this._submitBtn.name}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})}}const n=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}checkResponse(e){return e.ok?e.json():Promise.reject(`Error fetching data: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(e=>this.checkResponse(e))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(e=>this.checkResponse(e))}editUserInfo({name:e,description:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(e=>this.checkResponse(e))}addNewCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(e=>this.checkResponse(e))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(e=>this.checkResponse(e))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(e=>this.checkResponse(e))}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(e=>this.checkResponse(e))}editAvatar({link:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>this.checkResponse(e))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"4a9d2b77-fdc3-443b-b9f6-848c3f9e0ab5","Content-Type":"application/json"}}),a=new class{constructor({nameSelector:e,titleSelector:t,avatarSelector:s}){this._userName=document.querySelector(e),this._userTitle=document.querySelector(t),this._userAvatar=document.querySelector(s)}getUserInfo(){return{name:this._userName.textContent,description:this._userTitle.textContent,avatar:this._userAvatar.src}}setUserInfo(e){this._userName.textContent=e.name,this._userTitle.textContent=e.description,this._userAvatar.src=e.avatar,this._userAvatar.alt=`Profile image of ${e.name}`}}({nameSelector:".profile__name",titleSelector:".profile__description",avatarSelector:".profile__image"});let o;Promise.all([n.getUserInfo(),n.getInitialCards()]).then(([e,t])=>{a.setUserInfo({name:e.name,description:e.about,avatar:e.avatar}),o=new s({items:t.reverse(),renderer:e=>{const t=L(e);o.addItem(t)}},".cards__list"),o.renderItems()}).catch(e=>{console.error("Error rendering cards:",e)});const d=new i("#avatar-modal",function(e){d.renderLoading(!0),n.editAvatar(e).then(e=>{l.src=e.avatar,d.close()}).catch(e=>{console.error("Failed to update avatar:",e)}).finally(()=>{d.renderLoading(!1)})});d.setEventListeners();const l=document.querySelector(".profile__image");l.addEventListener("click",()=>{d.open(),y.resetValidation()});const c=new i("#profile-modal",function(e){c.renderLoading(!0),n.editUserInfo(e).then(e=>{a.setUserInfo({name:e.name,description:e.about,avatar:e.avatar}),c.close()}).catch(e=>{console.error("Failed to update user info:",e)}).finally(()=>{c.renderLoading(!1)})});c.setEventListeners(),document.querySelector(".profile__edit-button").addEventListener("click",()=>{c.open(),S.resetValidation();const e=a.getUserInfo();c.setInputValues(e)});const h=new i("#card-modal",function(e){h.renderLoading(!0),n.addNewCard(e).then(e=>{const t=L(e);o.addItem(t),h.close(),C.resetValidation()}).catch(e=>{console.error("Failed to add new card:",e)}).finally(()=>{h.renderLoading(!1)})});h.setEventListeners(),document.querySelector(".profile__add-button").addEventListener("click",()=>{h.open(),C.resetValidation()});const _=new class extends r{constructor(e){super(e),this._previewImage=this._modal.querySelector(".modal__image"),this._previewCaption=this._modal.querySelector(".modal__caption")}open(e){this._previewImage.src=e.link,this._previewImage.alt=`Enlarged view of ${e.name}`,this._previewCaption.textContent=e.name,super.open()}}("#preview-modal");function u(e){_.open(e)}_.setEventListeners();const m=new i("#confirmation-modal",function(e){m.renderLoading(!0),n.deleteCard(e.cardId).then(()=>{p.removeCard(),p=null,m.close()}).catch(e=>{console.error(`Failed to delete card:${e}`)}).finally(()=>{m.renderLoading(!1)})});let p;function v(e){p=e,m.open(),m.setInputValues({cardId:e.cardId})}function f(e){e.isLiked?n.unlikeCard(e.cardId).then(()=>{e.toggleCardLike(),e.isLiked=!e.isLiked}).catch(e=>{console.error("Failed to dislike card:",e)}):n.likeCard(e.cardId).then(()=>{e.toggleCardLike(),e.isLiked=!e.isLiked}).catch(e=>{console.error("Failed to like card:",e)})}function L(t){return new e(t,"#card-template",u,v,f).generateCard()}m.setEventListeners();const g={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"},k=document.forms["profile-form"],E=document.forms["card-form"],b=document.forms["avatar-form"],S=new t(g,k),C=new t(g,E),y=new t(g,b);S.enableValidation(),C.enableValidation(),y.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxpQkFDQTRLLEVBQ0FHLEVBQ0FFLEdBRVVySixjQUNkLENBN0VBaUosRUFBa0IvRSxvQkFrRmxCLE1BQU1vRixFQUFTLENBQ2JDLGFBQWMsZUFDZHZJLGNBQWUsZ0JBQ2ZFLHFCQUFzQixzQkFDdEJFLG9CQUFxQiw4QkFDckJFLGdCQUFpQiwwQkFDakJFLFdBQVksNkJBSVJnSSxFQUFtQnRKLFNBQVN1SixNQUFNLGdCQUNsQ0MsRUFBZ0J4SixTQUFTdUosTUFBTSxhQUMvQkUsRUFBYXpKLFNBQVN1SixNQUFNLGVBRzVCakIsRUFBd0IsSUFBSTdILEVBQWMySSxFQUFRRSxHQUNsRFosRUFBcUIsSUFBSWpJLEVBQWMySSxFQUFRSSxHQUMvQ3JCLEVBQXVCLElBQUkxSCxFQUFjMkksRUFBUUssR0FFdkRuQixFQUFzQjFGLG1CQUN0QjhGLEVBQW1COUYsbUJBQ25CdUYsRUFBcUJ2RixrQiIsInNvdXJjZXMiOlsid2VicGFjazovL0Fyb3VuZFRoZVVTLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9Bcm91bmRUaGVVUy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kVGhlVVMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL0Fyb3VuZFRoZVVTLy4vc3JjL2NvbXBvbmVudHMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kVGhlVVMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhGb3JtLmpzIiwid2VicGFjazovL0Fyb3VuZFRoZVVTLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL0Fyb3VuZFRoZVVTLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL0Fyb3VuZFRoZVVTLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vQXJvdW5kVGhlVVMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVCdXR0b24sXG4gICAgaGFuZGxlTGlrZUJ1dHRvblxuICApIHtcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLmNhcmRJZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2ltYWdlID0gZGF0YS5saW5rO1xuICAgIHRoaXMuaXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uID0gaGFuZGxlRGVsZXRlQnV0dG9uO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24gPSBoYW5kbGVMaWtlQnV0dG9uO1xuICB9XG5cbiAgdG9nZ2xlQ2FyZExpa2UoKSB7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soe1xuICAgICAgICBuYW1lOiB0aGlzLl90aXRsZSxcbiAgICAgICAgbGluazogdGhpcy5faW1hZ2UsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKHRoaXMpO1xuICAgIH0pO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX3RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl90ZW1wbGF0ZS5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5faW1hZ2U7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX3RpdGxlO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIC8vIFJlbmRlciBjYXJkcycgY3VycmVudCBsaWtlIHN0YXRlcyB3aGVuIHBhZ2UgbG9hZHNcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiBcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0U2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxuICAgIF07XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRTZWxlY3Rvcik7XG4gIH1cbiAgX3Nob3dFcnJvcnMoaW5wdXRFbGVtZW50LCBlcnJvckVsZW1lbnQpIHtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlRXJyb3JzKGlucHV0RWxlbWVudCwgZXJyb3JFbGVtZW50KSB7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0Vycm9ycyhpbnB1dEVsZW1lbnQsIGVycm9yRWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVFcnJvcnMoaW5wdXRFbGVtZW50LCBlcnJvckVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIC8vQWRkIGVudGVyIGtleWRvd24gbGlzdGVuZXIgdG8gaW5wdXRzIHdoZW4gYWxsIGlucHV0cyBhcmUgdmFsaWRcbiAgICBpZiAodGhpcy5faW5wdXRMaXN0LmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpKSB7XG4gICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsaWNrKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgICApO1xuICAgICAgdGhpcy5faGlkZUVycm9ycyhpbnB1dEVsZW1lbnQsIGVycm9yRWxlbWVudCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9tb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XG4gIH1cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9tb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIC8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgLy8gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgLy8gX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xuICAvLyAgIC8vIENsb3NlIG1vZGFsIHZpYSAgRXNjIGtleVxuICAvLyAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gIC8vICAgICB0aGlzLmNsb3NlKCk7XG4gIC8vICAgfVxuICAvLyB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIENsb3NlIG1vZGFsIFZpYSBjbG9zZSBidXR0b25cbiAgICB0aGlzLl9tb2RhbENMb3NlQnV0dG9uID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX21vZGFsQ0xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIC8vIENsb3NlIG1vZGFsIHZpYSBvdmVybGF5IGNsaWNrXG4gICAgdGhpcy5fbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIENsb3NlIG1vZGFsIHZpYSAgRXNjIGtleVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEZvcm0gZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idXR0b25cIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgfSk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiU2F2aW5nIC4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG4ubmFtZTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsIi8vVE9ETzogaW1wb3J0IGNzcywgY2xhc3MgY29tcG9uZW50cywgJiBjb25zdGFudHNcblxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IE1vZGFsV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL01vZGFsV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Nb2RhbFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbi8vIEluc3RhbnRpYXRlIGNsYXNzIGZvciBBUEkgaW50ZXJhY3Rpb25zXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI0YTlkMmI3Ny1mZGMzLTQ0M2ItYjlmNi04NDhjM2Y5ZTBhYjVcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vL0luc3RhbnRpYXRlIGNsYXNzIGZvciBnZXR0aW5nICYgc2V0dGluZyB1c2VyIGluZm9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIHRpdGxlU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiLFxufSk7XG5cbi8vIFRPRE86IERpc3BsYXkgdGhlIHVzZXIncyBwcm9maWxlIGluZm8gYW5kIGNhcmQgcG9zdHMgd2hlbiBwYWdlIGxvYWRzXG5cbmxldCBjYXJkTGlzdDsgLy8gdG8gaG9sZCBTZWN0aW9uIGluc3RhbmNlIGZvciBjYXJkc1xuXG5mdW5jdGlvbiByZW5kZXJQYWdlKCkge1xuICAvLyBDYWxsIGFwaSB0byBmZXRjaCB1c2VyJ3MgY3VycmVudCBpbmZvIGFuZCBjYXJkcyBkYXRhXG4gIHJldHVybiAoXG4gICAgUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAgICAgLy8gYW5kIHRoZW4sIGlmIHN1Y2Nlc3NmdWxseSByZWFjaGVkOlxuICAgICAgLnRoZW4oKFt1c2VySW5mb09iaiwgaW5pdGlhbENhcmRzQXJyXSkgPT4ge1xuICAgICAgICAvLyBSZW5kZXIgdXNlciBpbmZvXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgICBuYW1lOiB1c2VySW5mb09iai5uYW1lLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB1c2VySW5mb09iai5hYm91dCxcbiAgICAgICAgICBhdmF0YXI6IHVzZXJJbmZvT2JqLmF2YXRhcixcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEluc3RhbnRpYXRlIFNlY3Rpb24gY2xhc3MgZm9yIGNyZWF0aW5nIHRoZSBjYXJkcyBhbmQgYWRkaW5nIHRoZW0gdG8gdGhlIERPTVxuICAgICAgICBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHNBcnIucmV2ZXJzZSgpLFxuICAgICAgICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcbiAgICAgICAgICAgICAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCIuY2FyZHNfX2xpc3RcIlxuICAgICAgICApO1xuICAgICAgICAvLyBhbmQgaXRpdGlhbGl6ZSBpdFxuICAgICAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcygpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJlbmRlcmluZyBjYXJkczpcIiwgZXJyb3IpO1xuICAgICAgfSlcbiAgKTtcbn1cblxuLy8gSW5pdGFsIGNhbGwgdG8gcmVuZGVyIGN1cnJlbnQgdXNlciBpbmZvICYgY2FyZHMgbGlzdFxucmVuZGVyUGFnZSgpO1xuXG4vL1RPRE86IEhhbmRsZSBvcGVuaW5nIGFuZCBzdWJtaXR0aW5nIFtFRElUIEFWQVRBUiBNT0RBTF1cblxuLy8gSW5zdGFudGlhdGUgZWRpdCBhdmF0YXIgcG9wdXAgc3ViY2xhc3NcbmNvbnN0IGF2YXRhck1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXCIjYXZhdGFyLW1vZGFsXCIsIHN1Ym1pdEF2YXRhckZvcm0pO1xuLy9hbmQgaW5pdGlhbGl6ZSBpdCBmb3IgaGFuZGxpbmcgbG9hZGluZyAmIGZvcm0gc3VibWl0XG5hdmF0YXJNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyAqKiBvcGVuICoqIGVkaXQgYXZhdGFyIG1vZGFsXG5cbmNvbnN0IGF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XG5cbmF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhdmF0YXJNb2RhbC5vcGVuKCk7XG4gIGF2YXRhckZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbi8vICoqIHN1Ym1pdCAqKiBmb3JtIGZvciBjaGFuZ2luZyBhdmF0YXIgaW1hZ2UgaW4gcHJvZmlsZVxuXG5mdW5jdGlvbiBzdWJtaXRBdmF0YXJGb3JtKGxpbmspIHtcbiAgLy8gcmVuZGVyIGxvYWRpbmcgc3RhdHVzIG9uIHN1Ym1pdCBidG4gdGV4dFxuICBhdmF0YXJNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuXG4gIC8vIENhbGwgYXBpIHdpdGggUEFUQ0ggcmVxdWVzdFxuICBhcGlcbiAgICAuZWRpdEF2YXRhcihsaW5rKVxuICAgIC8vIHRoZW4gcmVuZGVyIG5ldyBhdmF0YXIgaW1hZ2UgaW4gcHJvZmlsZVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBhdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XG4gICAgICBhdmF0YXJNb2RhbC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgYXZhdGFyOlwiLCBlcnJvcik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhdmF0YXJNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLy9UT0RPOiBIYW5kbGUgb3BlbmluZyAmIHN1Ym1pdHRpbmcgW1BST0ZJTEUgTU9EQUxdXG5cbi8vIEluc3RhbnRpYXRlIGVkaXQgcHJvZmlsZSBwb3B1cCBzdWJjbGFzc1xuY29uc3QgcHJvZmlsZU1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXCIjcHJvZmlsZS1tb2RhbFwiLCBzdWJtaXRQcm9maWxlRm9ybSk7XG4vLyBhbmQgaW5pdGlhbGl6ZSBpdFxucHJvZmlsZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vICoqIE9wZW4gKiogZWRpdCBwcm9maWxlIG1vZGFsXG5cbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcHJvZmlsZU1vZGFsLm9wZW4oKTtcbiAgLy8gUmVzZXQgdmFsaWRhdGlvbiBlcnJvcnMgaW4gY2FzZSB0aGUgdXNlciBwcmV2aW91c2x5IGNsb3NlZCBtb2RhbCBjb250YWluaW5nIGludmFsaWQgaW5wdXQgZGF0YVxuICBwcm9maWxlRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIC8vIEdldCB1c2VycyBjdXJyZW50IGluZm8gZnJvbSBET01cbiAgY29uc3QgY3VycmVudEluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICAvLyBTZXQgdGhlIGN1cnJlbnQgdmFsdWVzIGluIGZvcm0gaW5wdXRzXG4gIHByb2ZpbGVNb2RhbC5zZXRJbnB1dFZhbHVlcyhjdXJyZW50SW5mbyk7XG59KTtcblxuLy8gKiogU3VibWl0ICoqIHByb2ZpbGUgcG9wdXAgZm9ybSB0byBlZGl0IHVzZXIncyBuYW1lICYgYWJvdXQgaW5mb1xuXG5mdW5jdGlvbiBzdWJtaXRQcm9maWxlRm9ybShkYXRhKSB7XG4gIC8vIHJlbmRlciBsb2FkaW5nIHN0YXR1cyBvbiBzdWJtaXQgYnRuIHRleHRcbiAgcHJvZmlsZU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIC8vIENhbGwgYXBpIHRvIGFjY2VzcyB1c2VyJ3MgY3VycmVudCBwcm9maWxlIGRhdGFcbiAgYXBpXG4gICAgLmVkaXRVc2VySW5mbyhkYXRhKVxuICAgIC8vIGFuZCB1cGRhdGUgaXQgaWYgc3VjY2Vzc2Z1bFxuICAgIC50aGVuKCh1cGRhdGVkVXNlckluZm8pID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgbmFtZTogdXBkYXRlZFVzZXJJbmZvLm5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVkVXNlckluZm8uYWJvdXQsXG4gICAgICAgIGF2YXRhcjogdXBkYXRlZFVzZXJJbmZvLmF2YXRhcixcbiAgICAgIH0pO1xuICAgICAgcHJvZmlsZU1vZGFsLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHVwZGF0ZSB1c2VyIGluZm86XCIsIGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHByb2ZpbGVNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLy9UT0RPOiBoYW5kbGUgb3BlbmluZyAmIHN1Ym1pdHRpbmcgW0NBUkQgTU9EQUxdIHRvIGFkZCBuZXcgY2FyZFxuXG4vLyBJbnN0YW50aWF0ZSBuZXcgY2FyZCBwb3B1cCBzdWJjbGFzc1xuY29uc3QgY2FyZE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXCIjY2FyZC1tb2RhbFwiLCBzdWJtaXRDYXJkRm9ybSk7XG4vLyBhbmQgaW5pdGlhbGl6ZSBpdFxuY2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vICoqIE9wZW4gKiogbmV3IGNhcmQgbW9kYWxcblxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjYXJkTW9kYWwub3BlbigpO1xuICBjYXJkRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcblxuLy8gKiogU3VibWl0ICoqIHRoZSBjYXJkIHBvcHVwIGZvcm0gdG8gYWRkIHRvIHBhZ2VcblxuZnVuY3Rpb24gc3VibWl0Q2FyZEZvcm0oZGF0YSkge1xuICAvLyByZW5kZXIgbG9hZGluZyBzdGF0dXMgb24gc3VibWl0IGJ0biB0ZXh0XG4gIGNhcmRNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAvL2NhbGwgYXBpIGF0IHRoZSAvY2FyZHMgZW5kcG9pbnQgdG8gc3RvcmUgY2FyZFxuICBhcGlcbiAgICAuYWRkTmV3Q2FyZChkYXRhKVxuICAgIC8vIGFuZCB0aGVuIGNyZWF0ZSBuZXcgY2FyZCBhbmQgYWRkIGl0IHRoZSBET00gaWYgUE9TVCBjYWxsIGlzIHN1Y2Nlc3NmdWxcbiAgICAudGhlbigobmV3Q2FyZERhdGEpID0+IHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChuZXdDYXJkRGF0YSk7XG4gICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgIGNhcmRNb2RhbC5jbG9zZSgpO1xuICAgICAgY2FyZEZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBhZGQgbmV3IGNhcmQ6XCIsIGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGNhcmRNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLy9UT0RPOiAgSGFuZGxlIG9wZW5pbmcgW1BSRVZJRVcgTU9EQUxdIHRvIHZpZXcgYSBsYXJnZXIgY2FyZCBpbWFnZVxuXG4vLyBJbnN0YW50aWF0ZSB0aGUgaW1hZ2UgcG9wdXAgc3ViY2xhc3NcbmNvbnN0IHByZXZpZXdNb2RhbCA9IG5ldyBNb2RhbFdpdGhJbWFnZShcIiNwcmV2aWV3LW1vZGFsXCIpO1xuLy8gYW5kIGluaXRpYWxpemUgaXRcbnByZXZpZXdNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyAqKiBPcGVuICoqIGltYWdlIHBvcHVwIG9uIGNhcmQgaW1hZ2UgY2xpY2tcbmZ1bmN0aW9uIG9wZW5QcmV2aWV3TW9kYWwoZGF0YSkge1xuICBwcmV2aWV3TW9kYWwub3BlbihkYXRhKTtcbn1cblxuLy9UT0RPOiBIYW5kbGUgb3BlbmluZyAmIHN1Ym1pdHRpbmcgW0NPTkZJUk1BVElPTiBNT0RBTF0gdG8gZGVsZXRlIGNhcmRcblxuLy8gSW5zdGFudGlhdGUgY29uZmlybWF0aW9uIHBvcHVwIHN1YmNsYXNzXG5jb25zdCBjb25maXJtYXRpb25Nb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtKFxuICBcIiNjb25maXJtYXRpb24tbW9kYWxcIixcbiAgc3VibWl0Q29uZmlybWF0aW9uRm9ybVxuKTtcbi8vIGFuZCBpbml0aWFsaXplIGl0XG5jb25maXJtYXRpb25Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyAqKiBPcGVuICoqIGNvbmZpcm1hdGlvbiBtb2RhbCBvbiBkZWxldGUgYnV0dG9uIGNsaWNrXG5cbmxldCBjYXJkVG9EZWxldGU7XG5cbmZ1bmN0aW9uIG9wZW5Db25maXJtYXRpb25Nb2RhbChjYXJkKSB7XG4gIGNhcmRUb0RlbGV0ZSA9IGNhcmQ7XG4gIGNvbmZpcm1hdGlvbk1vZGFsLm9wZW4oKTtcbiAgY29uZmlybWF0aW9uTW9kYWwuc2V0SW5wdXRWYWx1ZXMoeyBjYXJkSWQ6IGNhcmQuY2FyZElkIH0pO1xufVxuXG4vLyAqKiBTdWJtaXQgKiogY29uZmlybWF0aW9uIG1vZGFsIGZvcm0gdG8gZGVsZXRlIGNhcmRcblxuZnVuY3Rpb24gc3VibWl0Q29uZmlybWF0aW9uRm9ybShkYXRhKSB7XG4gIC8vIHJlbmRlciBsb2FkaW5nIHN0YXR1cyBvbiBzdWJtaXQgYnRuIHRleHRcbiAgY29uZmlybWF0aW9uTW9kYWwucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgLy9jYWxsIEFQSSB0byBkZWxldGUgdGhlIGNhcmRcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoZGF0YS5jYXJkSWQpXG4gICAgLy8gYW5kIHRoZW4gcmVtb3ZlIGl0IGZyb20gdGhlIERPTSBpZiB0aGUgQVBJIGNhbGwgaXMgc3VjY2Vzc2Z1bC5cbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjYXJkVG9EZWxldGUucmVtb3ZlQ2FyZCgpO1xuICAgICAgY2FyZFRvRGVsZXRlID0gbnVsbDtcbiAgICAgIGNvbmZpcm1hdGlvbk1vZGFsLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gZGVsZXRlIGNhcmQ6JHtlcnJvcn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGNvbmZpcm1hdGlvbk1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG4vLyBUT0RPOiBoYW5kbGUgW2NhcmQgbGlrZS1idXR0b25dXG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmRMaWtlKGNhcmQpIHtcbiAgLy8gSWYgY2FyZCBpcyBhbHJlYWR5IGxpa2VkLCBjYWxsIEFQSSB3L0RFTEVURSByZXF1ZXN0XG4gIGlmIChjYXJkLmlzTGlrZWQpIHtcbiAgICBhcGlcbiAgICAgIC51bmxpa2VDYXJkKGNhcmQuY2FyZElkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyB0aGVuIHJlbmRlciBmbGlwcGVkIGxpa2Ugc3RhdGUgb24gcGFnZVxuICAgICAgICBjYXJkLnRvZ2dsZUNhcmRMaWtlKCk7XG4gICAgICAgIC8vIGFuZCBmbGlwIHRoZSBpbnRlcm5hbCBsaWtlIHN0YXR1c1xuICAgICAgICBjYXJkLmlzTGlrZWQgPSAhY2FyZC5pc0xpa2VkO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBkaXNsaWtlIGNhcmQ6XCIsIGVycm9yKTtcbiAgICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIC8vIElmIGNhcmQgaXMgTk9UIGFscmVhZHkgbGlrZWQsIGNhbGwgQVBJIHcvUFVUIHJlcXVlc3RcbiAgICBhcGlcbiAgICAgIC5saWtlQ2FyZChjYXJkLmNhcmRJZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gdGhlbiByZW5kZXIgZmxpcHBlZCBsaWtlIHN0YXRlIG9uIHBhZ2VcbiAgICAgICAgY2FyZC50b2dnbGVDYXJkTGlrZSgpO1xuICAgICAgICAvLyBhbmQgZmxpcCB0aGUgaW50ZXJuYWwgbGlrZSBzdGF0dXNcbiAgICAgICAgY2FyZC5pc0xpa2VkID0gIWNhcmQuaXNMaWtlZDtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbGlrZSBjYXJkOlwiLCBlcnJvcik7XG4gICAgICB9KTtcbiAgfVxufVxuXG4vL1RPRE86ICBDcmVhdGUgW25ldyBjYXJkIGZ1bmN0aW9uXVxuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGRhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIG9wZW5QcmV2aWV3TW9kYWwsXG4gICAgb3BlbkNvbmZpcm1hdGlvbk1vZGFsLFxuICAgIGhhbmRsZUNhcmRMaWtlXG4gICk7XG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xufVxuXG4vL1RPRE86IFtGb3JtIHZhbGlkYXRpb25dIGZvciB0aGUgZWRpdGluZyBwcm9maWxlIGFuZCBhZGRpbmcgYSBuZXcgY2FyZCBwb3B1cCBmb3Jtc1xuXG4vLyBTZXQgb3B0aW9ucyBvYmplY3QgZm9yIGNvbmZpZ3VyYXRpb25cbmNvbnN0IGNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXG59O1xuXG4vLyBTZWFyY2ggZm9yIHRoZSBmb3Jtc1xuY29uc3QgcHJvZmlsZU1vZGFsRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1mb3JtXCJdO1xuY29uc3QgY2FyZE1vZGFsRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiY2FyZC1mb3JtXCJdO1xuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyLWZvcm1cIl07XG5cbi8vSW5zdGFudGlhdGUgdmFsaWRhdGlvbiBmb3IgYWxsIGZvcm1zXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVNb2RhbEZvcm0pO1xuY29uc3QgY2FyZEZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBjYXJkTW9kYWxGb3JtKTtcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhdmF0YXJGb3JtKTtcbi8vIGFuZCBlbmFibGUgdGhlbSB3aGVuIHRoZSBwYWdlIGxvYWRzXG5wcm9maWxlRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xuY2FyZEZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcbmF2YXRhckZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBjaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yIGZldGNoaW5nIGRhdGE6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLmNoZWNrUmVzcG9uc2UocmVzKSk7XG4gIH1cblxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgbGluazogbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5jaGVja1Jlc3BvbnNlKHJlcykpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5jaGVja1Jlc3BvbnNlKHJlcykpO1xuICB9XG5cbiAgdW5saWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfVxuXG4gIGVkaXRBdmF0YXIoeyBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgdGl0bGVTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3VzZXJUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGl0bGVTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgY3VycmVudFVzZXJJbmZvID0ge1xuICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fdXNlclRpdGxlLnRleHRDb250ZW50LFxuICAgICAgYXZhdGFyOiB0aGlzLl91c2VyQXZhdGFyLnNyYyxcbiAgICB9O1xuICAgIHJldHVybiBjdXJyZW50VXNlckluZm87XG4gIH1cblxuICBzZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fdXNlclRpdGxlLnRleHRDb250ZW50ID0gZGF0YS5kZXNjcmlwdGlvbjtcbiAgICB0aGlzLl91c2VyQXZhdGFyLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgIHRoaXMuX3VzZXJBdmF0YXIuYWx0ID0gYFByb2ZpbGUgaW1hZ2Ugb2YgJHtkYXRhLm5hbWV9YDtcbiAgfVxufVxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEltYWdlIGV4dGVuZHMgTW9kYWwge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5fcHJldmlld0ltYWdlID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG4gICAgdGhpcy5fcHJldmlld0NhcHRpb24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UuYWx0ID0gYEVubGFyZ2VkIHZpZXcgb2YgJHtkYXRhLm5hbWV9YDtcbiAgICB0aGlzLl9wcmV2aWV3Q2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImhhbmRsZUxpa2VCdXR0b24iLCJ0aGlzIiwiX3RpdGxlIiwibmFtZSIsImNhcmRJZCIsIl9pZCIsIl9pbWFnZSIsImxpbmsiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVMaWtlQnV0dG9uIiwidG9nZ2xlQ2FyZExpa2UiLCJfY2FyZExpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW1vdmVDYXJkIiwiX2VsZW1lbnQiLCJyZW1vdmUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEltYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiZ2VuZXJhdGVDYXJkIiwiX3RlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkVGl0bGUiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsImFkZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX3Nob3dFcnJvcnMiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlRXJyb3JzIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImlkIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInNvbWUiLCJkaXNhYmxlZCIsImZvckVhY2giLCJldmVyeSIsImlucHV0IiwiZXZ0Iiwia2V5IiwiY2xpY2siLCJlbmFibGVWYWxpZGF0aW9uIiwicmVzZXRWYWxpZGF0aW9uIiwicmVzZXQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiTW9kYWwiLCJtb2RhbFNlbGVjdG9yIiwiX21vZGFsIiwib3BlbiIsImNsb3NlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfbW9kYWxDTG9zZUJ1dHRvbiIsInRhcmdldCIsImNvbnRhaW5zIiwiTW9kYWxXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm0iLCJfc3VibWl0QnRuIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsInByZXZlbnREZWZhdWx0IiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJnZXRVc2VySW5mbyIsImVkaXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImFkZE5ld0NhcmQiLCJkZWxldGVDYXJkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiZWRpdEF2YXRhciIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsInRpdGxlU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl91c2VyTmFtZSIsIl91c2VyVGl0bGUiLCJfdXNlckF2YXRhciIsInNldFVzZXJJbmZvIiwiY2FyZExpc3QiLCJhbGwiLCJ1c2VySW5mb09iaiIsImluaXRpYWxDYXJkc0FyciIsInJldmVyc2UiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImF2YXRhck1vZGFsIiwiZmluYWxseSIsImF2YXRhckZvcm1WYWxpZGF0aW9uIiwicHJvZmlsZU1vZGFsIiwidXBkYXRlZFVzZXJJbmZvIiwicHJvZmlsZUZvcm1WYWxpZGF0aW9uIiwiY3VycmVudEluZm8iLCJjYXJkTW9kYWwiLCJuZXdDYXJkRGF0YSIsImNhcmRGb3JtVmFsaWRhdGlvbiIsInByZXZpZXdNb2RhbCIsIl9wcmV2aWV3SW1hZ2UiLCJfcHJldmlld0NhcHRpb24iLCJvcGVuUHJldmlld01vZGFsIiwiY29uZmlybWF0aW9uTW9kYWwiLCJjYXJkVG9EZWxldGUiLCJvcGVuQ29uZmlybWF0aW9uTW9kYWwiLCJjYXJkIiwiaGFuZGxlQ2FyZExpa2UiLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlTW9kYWxGb3JtIiwiZm9ybXMiLCJjYXJkTW9kYWxGb3JtIiwiYXZhdGFyRm9ybSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9